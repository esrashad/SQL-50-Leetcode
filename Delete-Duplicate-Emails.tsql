WITH ranktable AS (
    SELECT *,
           ROW_NUMBER() OVER(PARTITION BY email ORDER BY id) AS rn
    FROM Person
)
DELETE FROM ranktable
WHERE rn > 1

