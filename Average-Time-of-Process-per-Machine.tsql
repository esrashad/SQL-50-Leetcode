WITH start_activity AS (
    SELECT machine_id, process_id, timestamp 
    FROM Activity 
    WHERE activity_type = 'start'
),
end_activity AS (
    SELECT machine_id, process_id, timestamp 
    FROM Activity 
    WHERE activity_type = 'end'
)

select e.machine_id,round(avg(e.timestamp - s.timestamp),3) as processing_time 
from end_activity e
join start_activity s
on s.machine_id = e.machine_id and s.process_id = e.process_id
group by e.machine_id


